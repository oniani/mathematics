---
title: Homework \textnumero 3
author: David Oniani
date: \today
output: pdf_document
---

<!-- Do Exercises 6.10, 6.26, 6.34 -->

\tableofcontents
\clearpage

## Setup

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(MASS)
library(Stat2Data)
library(dplyr)
library(emmeans)
library(ggplot2)

# I like the minimal theme
theme_set(theme_minimal())

# Disable warnings (they clutter the document)
options(warn = -1)
```

\clearpage

## Exercise 6.10

\begin{itemize}
    \item[(a)]
        \(3 - 1 = 2\). Hence, we have 2 degrees of freedom for factor \(A\).
    \item[(b)]
        \(3 - 1 = 2\). Hence, we have 2 degrees of freedom for factor \(B\).
    \item[(c)]
        \((3 - 1) \times (3 - 1) = 2 \times 2 = 4\). Hence, we have 4 degrees of
        freedom for Error.
\end{itemize}

## Exercise 6.26

\begin{itemize}
    \item[(a)]
        This is an observational study as the study did not affect or control
        the subjects in any way.
    \item[(b)]
        \begin{itemize}
            \item Factors of interest: word lists (note that the study suggested
                that within each word list, words are of equal hearing
                difficulty, but we do not know if this is the case across the
                word lists/groups).
            \item Nuisance factors: volume and background noise
        \end{itemize}
    \item[(c)]
        Subjects with normal hearing.
    \item[(d)]
        We know that the variability within blocks is less than the variability
        between blocks (since within blocks/word lists, words are of equal
        hearing difficulty). Hence, this is a randomized block design with 4
        levels. Since there are 24 subjects in the study, the block size is 24.
\end{itemize}

```{r}
data(HearingTest)

# Data processing
df1 = HearingTest

l1 = df1[df1$List == "L1",]$Percent
l2 = df1[df1$List == "L2",]$Percent
l3 = df1[df1$List == "L3",]$Percent
l4 = df1[df1$List == "L4",]$Percent

df2 = data.frame(c(1:24), l1, l2, l3, l4)
df2$Mean = rowMeans(df2[,-1])
colnames(df2) = c("Sub", "L1", "L2", "L3", "L4", "Mean")

mean_l1 = round(mean(df2$L1))
mean_l2 = round(mean(df2$L2))
mean_l3 = round(mean(df2$L3))
mean_l4 = round(mean(df2$L4))
mean_mean = round(mean(df2$Mean), 1)

tmp = data.frame(nrow(df2) + 1, mean_l1, mean_l2, mean_l3, mean_l4, mean_mean)
colnames(tmp) = c("Sub", "L1", "L2", "L3", "L4", "Mean")
df3 = rbind(df2, tmp)
rownames(df3) = c(c(1:24), "Mean")
```

\clearpage

## Exercise 6.36

```{r}
data("Alfalfa")

# (a)
df4 = Alfalfa$Ht4
mean_df4 = mean(df4)
sd_df4 = sd(df4)

print(mean_df4)
print(sd_df4)

lr = lm(Ht4 ~ Acid + Row, Alfalfa)
summary(lr)

# (b)
# ANOVA
s = summary(aov(Ht4 ~ Acid + Row, data=Alfalfa))
print(s)

# (c)
# Residual analysis
par(mfrow = c(1,2))
plot(lr, which = 1:2)
# Reset
par(mfrow = c(1,1))
```

\begin{itemize}
    \item[(a)]
        The average for the growth in all 15 cups is 1.74 and the standard
        deviation for the growth in all 15 cups is approximately 1.11.
    \item[(b)]
        Performed the ANOVA (see the code above).
    \item[(c)]
        We can see that the acids are all independent of each other and thus,
        the condition for independence holds. From Residuals vs Fitted plot, we
        see that the red line is does not necessarily align with the black
        dotted line and is not flat. This means that there is some non-linear
        trend to the residuals. In the Normal QQ plot, we see that there are
        some data points that deviates form the dotted line. Hence, not all
        ANOVA conditions are met.
    \item[(d)]
        Based on the ANOVA table, we can conclude that there is a significant
        difference in average growth due to the treatments. This is the case
        since the p-value is significant.
    \item[(e)]
        Based on the ANOVA table, we cannot conclude that there is a significant
        difference in average growth due to the distance from the window. This
        is the case since the p-value is not significant.
\end{itemize}
